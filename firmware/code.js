(()=>{"use strict";var t,n=function(t){return function(n){t.mode("input"),setWatch(n,t,{repeat:!0,edge:"both",debounce:10})}};!function(t){t[t.POWER=378130479]="POWER",t[t.MINUS=378134559]="MINUS",t[t.PLUS=378132519]="PLUS",t[t.RED=378077439]="RED",t[t.GREEN=378126399]="GREEN",t[t.BLUE=378110079]="BLUE",t[t.CROSS=378114159]="CROSS",t[t.SQUARE=378118239]="SQUARE",t[t.TRIANGLE=378093759]="TRIANGLE",t[t.TOP_LEFT=378097839]="TOP_LEFT",t[t.TOP=378101919]="TOP",t[t.TOP_RIGHT=378099879]="TOP_RIGHT",t[t.LEFT=378081519]="LEFT",t[t.PLAY=378091719]="PLAY",t[t.RIGHT=378116199]="RIGHT",t[t.BOTTOM_LEFT=378083559]="BOTTOM_LEFT",t[t.BOTTOM=378124359]="BOTTOM",t[t.BOTTOM_RIGHT=378085599]="BOTTOM_RIGHT",t[t.X=378089679]="X",t[t.Y=378122319]="Y",t[t.Z=378105999]="Z"}(t||(t={}));var e,i,r,o=function(t,n,e){return n.mode("output"),t.mode("output"),analogWrite(t,0,{freq:e}),function(e){n.write(e>0),analogWrite(t,E.clip(Math.abs(e),0,1),null)}},u=o(P5,P4,100),s=o(P6,P7,100),c={OLED_WIDTH:128,OLED_CHAR:64,OLED_CHUNK:128},l=function(t,n,e){var i=0,r=1,o=null,u=null,s=0;n((function(){s+=r,u&&u(s)&&(i=0,t(0),o&&o())}));var c=null;return function(n){return r=n.direction?1:-1,0===i&&(i=n.startSpeed||.3),u=n.stopCondition,i=Math.min(1,1.05*i),t(i*(e?1:-1)*r),c||(c=new Promise((function(t,n){o=function(){t(s),s=0,c=null,o=null}}))),c}},a=function(){var t=this;this.subscribers=[],this.subscribe=function(n){return t.subscribers.push(n)},this.unsubscribe=function(n){return t.subscribers=t.subscribers.filter((function(t){return t!==n}))},this.publish=function(n){return t.subscribers.forEach((function(t){return t(n)}))}},f={oledReady:new a,irCodes:new a,leftWheelDone:new a,rightWheelDone:new a},h=function(){PrimaryI2C.setup({sda:SDA,scl:SCL});var t=function(t,n,e){var i=new Uint8Array([174,213,128,168,63,211,0,64,141,20,32,0,161,200,218,18,129,207,217,241,219,64,164,166,175]),r=[33,0,c.OLED_WIDTH-1,34,0,7],o=Graphics.createArrayBuffer(c.OLED_WIDTH,i[4]+1,1,{vertical_byte:!0}),u=60;return setTimeout((function(){i.forEach((function(n){t.writeTo(u,[0,n])}))}),50),void 0!==n&&setTimeout(n,100),o.flip=function(){r.forEach((function(n){t.writeTo(u,[0,n])}));var n=new Uint8Array(c.OLED_CHUNK+1);n[0]=c.OLED_CHAR;for(var e=0;e<this.buffer.length;e+=c.OLED_CHUNK)n.set(new Uint8Array(this.buffer,e,c.OLED_CHUNK),1),t.writeTo(u,n)},o.setContrast=function(n){return t.writeTo(u,0,129,n)},o.off=function(){return t.writeTo(u,0,174)},o.on=function(){return t.writeTo(u,0,175)},o}(PrimaryI2C,(function(){return f.oledReady.publish()})),e=n(P10),i=n(P11);!function(t,n){t.mode("input_pullup");var e=0,i=0,r=null,o=function(){0!=e&&(1===e?n(i):(n(e),i=e),e=0)};setWatch((function(t){var n=t.time-t.lastTime;null!==r&&(clearTimeout(r),r=null),n>.04?o():(e=e<<1|+(n>8e-4),r=setTimeout((function(){r=null,o()}),50))}),t,{repeat:!0,edge:"falling"})}(P3,(function(t){return f.irCodes.publish(t)}));var r,o,a=l(s,i,!1),h=l(u,e,!0);return{head:(r=P8,90,.675,2.325,o=function(t,n){switch(n){case"us":t=E.clip(t,675,2325),analogWrite(r,t/1e3/20,{freq:50});break;case"ms":t=E.clip(t,.675,2.325),analogWrite(r,t/20,{freq:50});break;default:t=E.clip(t,0,180),analogWrite(r,.03375+.0004583333333333333*(t-0),{freq:50})}},o(90),o),leftWheel:a,rightWheel:h,oled:t}}(),d={width:128,height:64,bpp:1,buffer:require("heatshrink").decompress(atob("AA0f/ANLgP/AAWAB5N/B4f+BxEPBwYAB+APHBYXgg4ECBwwKCCovgB4s/BAoWB/guGA4wXBMQgXBE4wIGj5HHFAKUEv6aIj6CEFw4wDIAUDVBK2B4CcCU5I6BUQTZLBYc/HxBACFYQzDgIXCj5LEIYQHDUIU/C4YMBCQQnFv43Dv/ADQZjBCgT+EJgMHLwYPIj/gh4PFIgIPEh/wj4GEB5H4EIIvLHoKOEB5BdBOwZvJB4JxBAwYPCDAkB/1/doavHB44AIB6H/B57eDABQPQH75veB4KmDB5S2DVoQADj7fEawIUBB4o6CB4MfB4MDfoR7EFQMH/Ef+BkCKYgGDh/4AIIYCEYIACEwcP+AhBHAQjBAAUPIwQ9BIIIFBn4DCAopdBEohADHwIlCRoJFDCYI0Cj5eCBgYGCeoXwEYIoCFgaQCAYIMBAAI+Cg5SDFYUHB4YXCBYZmDGAQuDPAgzBLgQEBDwZOBdgadFAAY2BXAd/dww+CdAh4BB46GDEoYwGBA55DYAj3FA4QXEDwIXGRoQmENBCcDUQZXHZYQADTgQAGv4ODPggAFVAIACLgqaHUg4A=="))},B=function(t){var n=e[t];n&&n(),e.default&&e.default(t)},T=function(t){e=t,f.irCodes.unsubscribe(B),f.irCodes.subscribe(B)},A=function(){function t(t){var n=this;this.changed=t,this.seconds=0,this.minutes=0,this.started=!1,this.startUp=function(){return new Promise((function(t,e){n.interval||(n.started=!1,n.interval=setInterval((function(){n.tick(1),n.started||(n.started=!0,t())}),1e3))}))}}return t.prototype.tick=function(t){this.seconds+=t,this.seconds>59?(this.seconds=0,this.minutes++):this.seconds<0&&(this.seconds=59,this.minutes--),this.changed(this.toString())},t.prototype.toString=function(){var t=function(t){return t>9?""+t:"0"+t};return t(this.minutes)+":"+t(this.seconds)},t.prototype.pause=function(){this.interval?this.stop():this.startUp()},t.prototype.stop=function(){clearInterval(this.interval),this.interval=null},t}(),C=!0,p=!1,g=[],I=null,P=function(t,n){var e=function(){return null==i},r=h.leftWheel({direction:t,stopCondition:e}),o=h.rightWheel({direction:n,stopCondition:e});I||(I=Promise.all([r,o])).then((function(t){var n=t[0],e=t[1];g.push([n,e]),I=null}))},v=function(){if(0!==g.length&&!I){var t=g[g.length-1],n=t[0],e=t[1],i=Promise.resolve(0),r=0==n?i:h.leftWheel({direction:n<0,stopCondition:function(t){return t+n==0}}),o=0==e?i:h.rightWheel({direction:e<0,stopCondition:function(t){return t+e==0}});(I=Promise.all([r,o])).then((function(){setTimeout((function(){g.splice(-1,1),I=null,v()}),1e3)}))}},w=(r=[["Timer",function(){h.oled.setFontVector(40);var n=new A((function(t){h.oled.clear(),h.oled.drawString(t,0,10),h.oled.flip()}));n.startUp().then((function(){var e;return T(((e={})[t.PLAY]=function(){return n.pause()},e[t.CROSS]=function(){n.stop(),w()},e))}))}],["Marsohod",function(){var n;h.oled.clear(),h.oled.drawImage(d,0,0),h.oled.flip(),T(((n={})[t.TOP]=function(){return P(C,C)},n[t.BOTTOM]=function(){return P(p,p)},n[t.LEFT]=function(){return P(p,C)},n[t.RIGHT]=function(){return P(C,p)},n[t.PLUS]=function(){return h.head(55)},n[t.MINUS]=function(){return h.head(125)},n[t.GREEN]=function(){return h.head(90)},n[t.PLAY]=function(){I||v()},n[t.CROSS]=w,n.default=function(){i&&clearTimeout(i),i=setTimeout((function(){i=null}),150)},n))}],["Else",function(){}]],function(){var n,e=0,i=function(){h.oled.setFontVector(15),h.oled.clear();for(var t=0;t<r.length;t++){var n=r[t],i=n[0],o=(n[1],t===e?"> "+i:"  "+i);h.oled.drawString(o,0,20*t)}h.oled.flip()},o=((n={})[t.TOP]=function(){e=Math.max(0,e-1),i()},n[t.BOTTOM]=function(){e=Math.min(r.length-1,e+1),i()},n[t.PLAY]=function(){var t=r[e];t[0],(0,t[1])()},n);i(),T(o)});f.oledReady.subscribe((function(){h.oled&&(h.oled.clear(),h.oled.setFontVector(15),h.oled.drawImage(d,0,0),h.oled.flip()),setTimeout(w,5e3)}))})();