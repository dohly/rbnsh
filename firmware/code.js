(()=>{"use strict";var e;!function(e){e[e.POWER=378130479]="POWER",e[e.MINUS=378134559]="MINUS",e[e.PLUS=378132519]="PLUS",e[e.RED=378077439]="RED",e[e.GREEN=378126399]="GREEN",e[e.BLUE=378110079]="BLUE",e[e.CROSS=378114159]="CROSS",e[e.SQUARE=378118239]="SQUARE",e[e.TRIANGLE=378093759]="TRIANGLE",e[e.TOP_LEFT=378097839]="TOP_LEFT",e[e.TOP=378101919]="TOP",e[e.TOP_RIGHT=378099879]="TOP_RIGHT",e[e.LEFT=378081519]="LEFT",e[e.PLAY=378091719]="PLAY",e[e.RIGHT=378116199]="RIGHT",e[e.BOTTOM_LEFT=378083559]="BOTTOM_LEFT",e[e.BOTTOM=378124359]="BOTTOM",e[e.BOTTOM_RIGHT=378085599]="BOTTOM_RIGHT",e[e.X=378089679]="X",e[e.Y=378122319]="Y",e[e.Z=378105999]="Z"}(e||(e={}));var t=function(e){return function(t){e.mode("input"),setWatch(t,e,{repeat:!0,edge:"both",debounce:10})}},n=function(e,t,n){return t.mode("output"),e.mode("output"),analogWrite(e,0,{freq:n}),function(n){t.write(n>0),analogWrite(e,E.clip(Math.abs(n),0,1),null)}},r=n(P5,P4,100),i=n(P6,P7,100),o={OLED_WIDTH:128,OLED_CHAR:64,OLED_CHUNK:128},u=function(e,t,n){var r=0,i=.25,o=1;return t((function(){r>0?r--:(i=.25,e(0))})),function(t){o=n?t>0?1:-1:t>0?-1:1,r+=Math.abs(t),i=Math.min(1,i+.01),e(i*o)}},a=function(){var e=this;this.subscribers=[],this.subscribe=function(t){return e.subscribers.push(t)},this.unsubscribe=function(t){return e.subscribers=e.subscribers.filter((function(e){return e!==t}))},this.publish=function(t){return e.subscribers.forEach((function(e){return e(t)}))}},c={oledReady:new a,irCodes:new a},f=function(){PrimaryI2C.setup({sda:SDA,scl:SCL});var e,n,a=function(e,t,n){var r=new Uint8Array([174,213,128,168,63,211,0,64,141,20,32,0,161,200,218,18,129,207,217,241,219,64,164,166,175]),i=[33,0,o.OLED_WIDTH-1,34,0,7],u=Graphics.createArrayBuffer(o.OLED_WIDTH,r[4]+1,1,{vertical_byte:!0}),a=60;return setTimeout((function(){r.forEach((function(t){e.writeTo(a,[0,t])}))}),50),void 0!==t&&setTimeout(t,100),u.flip=function(){i.forEach((function(t){e.writeTo(a,[0,t])}));var t=new Uint8Array(o.OLED_CHUNK+1);t[0]=o.OLED_CHAR;for(var n=0;n<this.buffer.length;n+=o.OLED_CHUNK)t.set(new Uint8Array(this.buffer,n,o.OLED_CHUNK),1),e.writeTo(a,t)},u.setContrast=function(t){return e.writeTo(a,0,129,t)},u.off=function(){return e.writeTo(a,0,174)},u.on=function(){return e.writeTo(a,0,175)},u}(PrimaryI2C,(function(){return c.oledReady.publish()})),f=t(P10),l=t(P11);return function(e,t){e.mode("input_pullup");var n=0,r=0,i=null,o=function(){0!=n&&(1===n?t(r):(t(n),r=n),n=0)};setWatch((function(e){var t=e.time-e.lastTime;null!==i&&(clearTimeout(i),i=null),t>.04?o():(n=n<<1|+(t>8e-4),i=setTimeout((function(){i=null,o()}),50))}),e,{repeat:!0,edge:"falling"})}(P3,(function(e){return c.irCodes.publish(e)})),{head:(e=P8,90,.675,2.325,n=function(t,n){switch(n){case"us":t=E.clip(t,675,2325),analogWrite(e,t/1e3/20,{freq:50});break;case"ms":t=E.clip(t,.675,2.325),analogWrite(e,t/20,{freq:50});break;default:t=E.clip(t,0,180),analogWrite(e,.03375+.0004583333333333333*(t-0),{freq:50})}},n(90),n),leftWheel:u(r,l,!1),rightWheel:u(i,f,!0),oled:a}}(),l=[],s=function(e,t){l.push([e,t]),f.leftWheel(e),f.rightWheel(t)},B={},A=!0;B[e.TOP]=function(){A?(d=20==d?40:20,T()):s(6,6)},B[e.BOTTOM]=function(){A?(d=20==d?40:20,T()):s(-6,-6)},B[e.LEFT]=function(){s(-1,1)},B[e.RIGHT]=function(){s(1,-1)},B[e.PLUS]=function(){f.head(55)},B[e.MINUS]=function(){f.head(125)},B[e.GREEN]=function(){f.head(90)},B[e.CROSS]=function(){for(var e=l.length-1;e>0;e--){var t=l[e],n=t[0],r=t[1];f.leftWheel(-1*n),f.rightWheel(-1*r)}l=[]},B[e.PLAY]=function(){if(f.oled.setFontVector(15),f.oled.clear(),20==d){var e={width:128,height:64,bpp:1,buffer:require("heatshrink").decompress(atob("AA0f/ANLgP/AAWAB5N/B4f+BxEPBwYAB+APHBYXgg4ECBwwKCCovgB4s/BAoWB/guGA4wXBMQgXBE4wIGj5HHFAKUEv6aIj6CEFw4wDIAUDVBK2B4CcCU5I6BUQTZLBYc/HxBACFYQzDgIXCj5LEIYQHDUIU/C4YMBCQQnFv43Dv/ADQZjBCgT+EJgMHLwYPIj/gh4PFIgIPEh/wj4GEB5H4EIIvLHoKOEB5BdBOwZvJB4JxBAwYPCDAkB/1/doavHB44AIB6H/B57eDABQPQH75veB4KmDB5S2DVoQADj7fEawIUBB4o6CB4MfB4MDfoR7EFQMH/Ef+BkCKYgGDh/4AIIYCEYIACEwcP+AhBHAQjBAAUPIwQ9BIIIFBn4DCAopdBEohADHwIlCRoJFDCYI0Cj5eCBgYGCeoXwEYIoCFgaQCAYIMBAAI+Cg5SDFYUHB4YXCBYZmDGAQuDPAgzBLgQEBDwZOBdgadFAAY2BXAd/dww+CdAh4BB46GDEoYwGBA55DYAj3FA4QXEDwIXGRoQmENBCcDUQZXHZYQADTgQAGv4ODPggAFVAIACLgqaHUg4A=="))};f.oled.drawImage(e,0,0),A=!1}else f.oled.drawString("=(",0,0),A=!1;f.oled.flip()};var d=20;function T(){f.oled.clear(),f.oled.drawString("KAK DELA?",0,0),f.oled.drawString("ZASHIBIS",20,20),f.oled.drawString("TAK SEBE",20,40),f.oled.drawString(">",0,d),f.oled.flip()}c.oledReady.subscribe((function(){f.oled&&(f.oled.setFontVector(15),f.oled.clear(),f.oled.drawString("PRIVET",0,0),f.oled.flip()),setTimeout(T,5e3)})),c.irCodes.subscribe((function(e){var t=B[e];t&&t()})),new Promise((function(e,t){setTimeout((function(){f.head(45),e()}),7e3)})).then((function(){f.oled.clear(),f.oled.drawString("Ok, PROMISE",0,0),f.oled.flip()}))})();