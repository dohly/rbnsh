(()=>{"use strict";var e;!function(e){e[e.POWER=378130479]="POWER",e[e.MINUS=378134559]="MINUS",e[e.PLUS=378132519]="PLUS",e[e.RED=378077439]="RED",e[e.GREEN=378126399]="GREEN",e[e.BLUE=378110079]="BLUE",e[e.CROSS=378114159]="CROSS",e[e.SQUARE=378118239]="SQUARE",e[e.TRIANGLE=378093759]="TRIANGLE",e[e.TOP_LEFT=378097839]="TOP_LEFT",e[e.TOP=378101919]="TOP",e[e.TOP_RIGHT=378099879]="TOP_RIGHT",e[e.LEFT=378081519]="LEFT",e[e.PLAY=378091719]="PLAY",e[e.RIGHT=378116199]="RIGHT",e[e.BOTTOM_LEFT=378083559]="BOTTOM_LEFT",e[e.BOTTOM=378124359]="BOTTOM",e[e.BOTTOM_RIGHT=378085599]="BOTTOM_RIGHT",e[e.X=378089679]="X",e[e.Y=378122319]="Y",e[e.Z=378105999]="Z"}(e||(e={}));var n=function(e){return function(n){e.mode("input"),setWatch(n,e,{repeat:!0,edge:"both",debounce:10})}},t=function(e,n,t){return n.mode("output"),e.mode("output"),analogWrite(e,0,{freq:t}),function(t){n.write(t>0),analogWrite(e,E.clip(Math.abs(t),0,1),null)}},r=t(P5,P4,100),i=t(P6,P7,100),o={OLED_WIDTH:128,OLED_CHAR:64,OLED_CHUNK:128},u=.3,l=function(e,n,t){var r=0,i=u,o=1,l=null,f=0;n((function(){r>0?(r--,a()):(i=u,e(0),l&&l())}));var a=function(){i=Math.min(1,i+.01),e(i*o)},c=null;return function(e,n){return o=t?e>0?1:-1:e>0?-1:1,r+=Math.abs(e),f+=e,i===u&&(i=n||u,a()),c||(c=new Promise((function(e,n){l=function(){e(f),f=0,c=null,l=null}}))),c}},f=function(){var e=this;this.subscribers=[],this.subscribe=function(n){return e.subscribers.push(n)},this.unsubscribe=function(n){return e.subscribers=e.subscribers.filter((function(e){return e!==n}))},this.publish=function(n){return e.subscribers.forEach((function(e){return e(n)}))}},a={oledReady:new f,irCodes:new f,leftWheelDone:new f,rightWheelDone:new f},c=function(){PrimaryI2C.setup({sda:SDA,scl:SCL});var e=function(e,n,t){var r=new Uint8Array([174,213,128,168,63,211,0,64,141,20,32,0,161,200,218,18,129,207,217,241,219,64,164,166,175]),i=[33,0,o.OLED_WIDTH-1,34,0,7],u=Graphics.createArrayBuffer(o.OLED_WIDTH,r[4]+1,1,{vertical_byte:!0}),l=60;return setTimeout((function(){r.forEach((function(n){e.writeTo(l,[0,n])}))}),50),void 0!==n&&setTimeout(n,100),u.flip=function(){i.forEach((function(n){e.writeTo(l,[0,n])}));var n=new Uint8Array(o.OLED_CHUNK+1);n[0]=o.OLED_CHAR;for(var t=0;t<this.buffer.length;t+=o.OLED_CHUNK)n.set(new Uint8Array(this.buffer,t,o.OLED_CHUNK),1),e.writeTo(l,n)},u.setContrast=function(n){return e.writeTo(l,0,129,n)},u.off=function(){return e.writeTo(l,0,174)},u.on=function(){return e.writeTo(l,0,175)},u}(PrimaryI2C,(function(){return a.oledReady.publish()})),t=n(P10),u=n(P11);!function(e,n){e.mode("input_pullup");var t=0,r=0,i=null,o=function(){0!=t&&(1===t?n(r):(n(t),r=t),t=0)};setWatch((function(e){var n=e.time-e.lastTime;null!==i&&(clearTimeout(i),i=null),n>.04?o():(t=t<<1|+(n>8e-4),i=setTimeout((function(){i=null,o()}),50))}),e,{repeat:!0,edge:"falling"})}(P3,(function(e){return a.irCodes.publish(e)}));var f,c,s=l(r,u,!1),B=l(i,t,!0);return{head:(f=P8,90,.675,2.325,c=function(e,n){switch(n){case"us":e=E.clip(e,675,2325),analogWrite(f,e/1e3/20,{freq:50});break;case"ms":e=E.clip(e,.675,2.325),analogWrite(f,e/20,{freq:50});break;default:e=E.clip(e,0,180),analogWrite(f,.03375+.0004583333333333333*(e-0),{freq:50})}},c(90),c),leftWheel:s,rightWheel:B,oled:e}}(),s=[],B=null,A=function(e,n){var t=c.leftWheel(e),r=c.rightWheel(n);B||(B=Promise.all([t,r])).then((function(e){var n=e[0],t=e[1];s.push([n,t]),B=null}))},h=function(){if(0!==s.length){var e=s[s.length-1],n=e[0],t=e[1],r=c.leftWheel(-n),i=c.rightWheel(-t);B||(B=Promise.all([r,i])).then((function(){setTimeout((function(){s.splice(-1,1),B=null,h()}),1e3)}))}},T={},d=!0;T[e.TOP]=function(){d?(I=20==I?40:20,g()):A(6,6)},T[e.BOTTOM]=function(){d?(I=20==I?40:20,g()):A(-6,-6)},T[e.LEFT]=function(){A(-1,1)},T[e.RIGHT]=function(){A(1,-1)},T[e.PLUS]=function(){c.head(55)},T[e.MINUS]=function(){c.head(125)},T[e.GREEN]=function(){c.head(90)},T[e.CROSS]=function(){for(var e=s.length-1;e>0;e--){var n=s[e],t=n[0],r=n[1];c.leftWheel(-1*t),c.rightWheel(-1*r)}s=[]},T[e.PLAY]=function(){if(d){if(c.oled.setFontVector(15),c.oled.clear(),20==I){var e={width:128,height:64,bpp:1,buffer:require("heatshrink").decompress(atob("AA0f/ANLgP/AAWAB5N/B4f+BxEPBwYAB+APHBYXgg4ECBwwKCCovgB4s/BAoWB/guGA4wXBMQgXBE4wIGj5HHFAKUEv6aIj6CEFw4wDIAUDVBK2B4CcCU5I6BUQTZLBYc/HxBACFYQzDgIXCj5LEIYQHDUIU/C4YMBCQQnFv43Dv/ADQZjBCgT+EJgMHLwYPIj/gh4PFIgIPEh/wj4GEB5H4EIIvLHoKOEB5BdBOwZvJB4JxBAwYPCDAkB/1/doavHB44AIB6H/B57eDABQPQH75veB4KmDB5S2DVoQADj7fEawIUBB4o6CB4MfB4MDfoR7EFQMH/Ef+BkCKYgGDh/4AIIYCEYIACEwcP+AhBHAQjBAAUPIwQ9BIIIFBn4DCAopdBEohADHwIlCRoJFDCYI0Cj5eCBgYGCeoXwEYIoCFgaQCAYIMBAAI+Cg5SDFYUHB4YXCBYZmDGAQuDPAgzBLgQEBDwZOBdgadFAAY2BXAd/dww+CdAh4BB46GDEoYwGBA55DYAj3FA4QXEDwIXGRoQmENBCcDUQZXHZYQADTgQAGv4ODPggAFVAIACLgqaHUg4A=="))};c.oled.drawImage(e,0,0),d=!1}else c.oled.drawString("=(",0,0),d=!1;c.oled.flip()}else h()};var I=20;function g(){c.oled.clear(),c.oled.drawString("KAK DELA?",0,0),c.oled.drawString("ZASHIBIS",20,20),c.oled.drawString("TAK SEBE",20,40),c.oled.drawString(">",0,I),c.oled.flip()}a.oledReady.subscribe((function(){c.oled&&(c.oled.setFontVector(15),c.oled.clear(),c.oled.drawString("PRIVET",0,0),c.oled.flip()),setTimeout(g,5e3)})),a.irCodes.subscribe((function(e){var n=T[e];n&&n()}))})();