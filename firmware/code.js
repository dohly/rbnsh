(()=>{"use strict";var n,e=function(n){return function(e){n.mode("input"),setWatch(e,n,{repeat:!0,edge:"both",debounce:10})}};!function(n){n[n.POWER=378130479]="POWER",n[n.MINUS=378134559]="MINUS",n[n.PLUS=378132519]="PLUS",n[n.RED=378077439]="RED",n[n.GREEN=378126399]="GREEN",n[n.BLUE=378110079]="BLUE",n[n.CROSS=378114159]="CROSS",n[n.SQUARE=378118239]="SQUARE",n[n.TRIANGLE=378093759]="TRIANGLE",n[n.TOP_LEFT=378097839]="TOP_LEFT",n[n.TOP=378101919]="TOP",n[n.TOP_RIGHT=378099879]="TOP_RIGHT",n[n.LEFT=378081519]="LEFT",n[n.PLAY=378091719]="PLAY",n[n.RIGHT=378116199]="RIGHT",n[n.BOTTOM_LEFT=378083559]="BOTTOM_LEFT",n[n.BOTTOM=378124359]="BOTTOM",n[n.BOTTOM_RIGHT=378085599]="BOTTOM_RIGHT",n[n.X=378089679]="X",n[n.Y=378122319]="Y",n[n.Z=378105999]="Z"}(n||(n={}));var t,r,o,i,u=function(n,e,t){return e.mode("output"),n.mode("output"),analogWrite(n,0,{freq:t}),function(t){e.write(t>0),analogWrite(n,E.clip(Math.abs(t),0,1),null)}},c=u(P5,P4,100),l=u(P6,P7,100),f={OLED_WIDTH:128,OLED_CHAR:64,OLED_CHUNK:128},a=function(n,e,t){var r=0,o=1,i=null,u=null,c=0;e((function(){c+=o,u&&u(c)&&(r=0,n(0),i&&i())}));var l=null;return function(e){return o=e.direction?1:-1,0===r&&(r=e.startSpeed||.3),u=e.stopCondition,r=Math.min(1,1.05*r),n(r*(t?1:-1)*o),l||(l=new Promise((function(n,e){i=function(){n(c),c=0,l=null,i=null}}))),l}},s=function(){var n=this;this.subscribers=[],this.subscribe=function(e){return n.subscribers.push(e)},this.unsubscribe=function(e){return n.subscribers=n.subscribers.filter((function(n){return n!==e}))},this.publish=function(e){return n.subscribers.forEach((function(n){return n(e)}))}},d={oledReady:new s,irCodes:new s,leftWheelDone:new s,rightWheelDone:new s},B=function(){PrimaryI2C.setup({sda:SDA,scl:SCL});var n=function(n,e,t){var r=new Uint8Array([174,213,128,168,63,211,0,64,141,20,32,0,161,200,218,18,129,207,217,241,219,64,164,166,175]),o=[33,0,f.OLED_WIDTH-1,34,0,7],i=Graphics.createArrayBuffer(f.OLED_WIDTH,r[4]+1,1,{vertical_byte:!0}),u=60;return setTimeout((function(){r.forEach((function(e){n.writeTo(u,[0,e])}))}),50),void 0!==e&&setTimeout(e,100),i.flip=function(){o.forEach((function(e){n.writeTo(u,[0,e])}));var e=new Uint8Array(f.OLED_CHUNK+1);e[0]=f.OLED_CHAR;for(var t=0;t<this.buffer.length;t+=f.OLED_CHUNK)e.set(new Uint8Array(this.buffer,t,f.OLED_CHUNK),1),n.writeTo(u,e)},i.setContrast=function(e){return n.writeTo(u,0,129,e)},i.off=function(){return n.writeTo(u,0,174)},i.on=function(){return n.writeTo(u,0,175)},i}(PrimaryI2C,(function(){return d.oledReady.publish()})),t=e(P10),r=e(P11);!function(n,e){n.mode("input_pullup");var t=0,r=0,o=null,i=function(){0!=t&&(1===t?e(r):(e(t),r=t),t=0)};setWatch((function(n){var e=n.time-n.lastTime;null!==o&&(clearTimeout(o),o=null),e>.04?i():(t=t<<1|+(e>8e-4),o=setTimeout((function(){o=null,i()}),50))}),n,{repeat:!0,edge:"falling"})}(P3,(function(n){return d.irCodes.publish(n)}));var o,i,u=a(l,r,!1),s=a(c,t,!0);return{head:(o=P8,90,.675,2.325,i=function(n,e){switch(e){case"us":n=E.clip(n,675,2325),analogWrite(o,n/1e3/20,{freq:50});break;case"ms":n=E.clip(n,.675,2.325),analogWrite(o,n/20,{freq:50});break;default:n=E.clip(n,0,180),analogWrite(o,.03375+.0004583333333333333*(n-0),{freq:50})}},i(90),i),leftWheel:u,rightWheel:s,oled:n}}(),T={width:128,height:64,bpp:1,buffer:require("heatshrink").decompress(atob("AA0f/ANLgP/AAWAB5N/B4f+BxEPBwYAB+APHBYXgg4ECBwwKCCovgB4s/BAoWB/guGA4wXBMQgXBE4wIGj5HHFAKUEv6aIj6CEFw4wDIAUDVBK2B4CcCU5I6BUQTZLBYc/HxBACFYQzDgIXCj5LEIYQHDUIU/C4YMBCQQnFv43Dv/ADQZjBCgT+EJgMHLwYPIj/gh4PFIgIPEh/wj4GEB5H4EIIvLHoKOEB5BdBOwZvJB4JxBAwYPCDAkB/1/doavHB44AIB6H/B57eDABQPQH75veB4KmDB5S2DVoQADj7fEawIUBB4o6CB4MfB4MDfoR7EFQMH/Ef+BkCKYgGDh/4AIIYCEYIACEwcP+AhBHAQjBAAUPIwQ9BIIIFBn4DCAopdBEohADHwIlCRoJFDCYI0Cj5eCBgYGCeoXwEYIoCFgaQCAYIMBAAI+Cg5SDFYUHB4YXCBYZmDGAQuDPAgzBLgQEBDwZOBdgadFAAY2BXAd/dww+CdAh4BB46GDEoYwGBA55DYAj3FA4QXEDwIXGRoQmENBCcDUQZXHZYQADTgQAGv4ODPggAFVAIACLgqaHUg4A=="))},h=function(n){var e=t[n];e&&e(),t.default&&t.default(n)},A=function(n){t=n,d.irCodes.unsubscribe(h),d.irCodes.subscribe(h)},C=new s,I=0,g=0,P=!1,w=function(){return new Promise((function(n,e){r||(P=!1,r=setInterval((function(){var e;(I+=1)>59?(I=0,g++):I<0&&(I=59,g--),C.publish((e=function(n){return n>9?""+n:"0"+n})(g)+":"+e(I)),P||(P=!0,n())}),1e3))}))},D=!0,O=!1,v=[],b=null,p=function(n,e){var t=function(){return null==o},r=B.leftWheel({direction:n,stopCondition:t}),i=B.rightWheel({direction:e,stopCondition:t});b||(b=Promise.all([r,i])).then((function(n){var e=n[0],t=n[1];v.push([e,t]),b=null}))},L=function(){if(0!==v.length&&!b){var n=v[v.length-1],e=n[0],t=n[1],r=Promise.resolve(0),o=0==e?r:B.leftWheel({direction:e<0,stopCondition:function(n){return n+e==0}}),i=0==t?r:B.rightWheel({direction:t<0,stopCondition:function(n){return n+t==0}});(b=Promise.all([o,i])).then((function(){setTimeout((function(){v.splice(-1,1),b=null,L()}),1e3)}))}},H=(i=[["Timer",function(){B.oled.setFontVector(40),C.subscribe((function(n){B.oled.clear(),B.oled.drawString(n,0,10),B.oled.flip()})),w().then((function(){var e;return A(((e={})[n.PLAY]=function(){r?(clearInterval(r),r=null):w()},e[n.CROSS]=function(){clearInterval(r),r=null,I=0,g=0,H()},e))}))}],["Marsohod",function(){var e;B.oled.clear(),B.oled.drawImage(T,0,0),B.oled.flip(),A(((e={})[n.TOP]=function(){return p(D,D)},e[n.BOTTOM]=function(){return p(O,O)},e[n.LEFT]=function(){return p(O,D)},e[n.RIGHT]=function(){return p(D,O)},e[n.PLUS]=function(){return B.head(55)},e[n.MINUS]=function(){return B.head(125)},e[n.GREEN]=function(){return B.head(90)},e[n.PLAY]=function(){b||L()},e[n.CROSS]=H,e.default=function(){o&&clearTimeout(o),o=setTimeout((function(){o=null}),150)},e))}],["Else",function(){}]],function(){var e,t=0,r=function(){B.oled.setFontVector(15),B.oled.clear();for(var n=0;n<i.length;n++){var e=i[n],r=e[0],o=(e[1],n===t?"> "+r:"  "+r);B.oled.drawString(o,0,20*n)}B.oled.flip()},o=((e={})[n.TOP]=function(){t=Math.max(0,t-1),r()},e[n.BOTTOM]=function(){t=Math.min(i.length-1,t+1),r()},e[n.PLAY]=function(){var n=i[t];n[0],(0,n[1])()},e);r(),A(o)});d.oledReady.subscribe((function(){B.oled&&(B.oled.clear(),B.oled.setFontVector(15),B.oled.drawImage(T,0,0),B.oled.flip()),setTimeout(H,5e3)}))})();