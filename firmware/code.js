(()=>{"use strict";var n,t=function(n){return function(t){n.mode("input"),setWatch(t,n,{repeat:!0,edge:"both",debounce:10})}};!function(n){n[n.POWER=378130479]="POWER",n[n.MINUS=378134559]="MINUS",n[n.PLUS=378132519]="PLUS",n[n.RED=378077439]="RED",n[n.GREEN=378126399]="GREEN",n[n.BLUE=378110079]="BLUE",n[n.CROSS=378114159]="CROSS",n[n.SQUARE=378118239]="SQUARE",n[n.TRIANGLE=378093759]="TRIANGLE",n[n.TOP_LEFT=378097839]="TOP_LEFT",n[n.TOP=378101919]="TOP",n[n.TOP_RIGHT=378099879]="TOP_RIGHT",n[n.LEFT=378081519]="LEFT",n[n.PLAY=378091719]="PLAY",n[n.RIGHT=378116199]="RIGHT",n[n.BOTTOM_LEFT=378083559]="BOTTOM_LEFT",n[n.BOTTOM=378124359]="BOTTOM",n[n.BOTTOM_RIGHT=378085599]="BOTTOM_RIGHT",n[n.X=378089679]="X",n[n.Y=378122319]="Y",n[n.Z=378105999]="Z"}(n||(n={}));var e,i,r,o=function(n,t,e){return t.mode("output"),n.mode("output"),analogWrite(n,0,{freq:e}),function(e){t.write(e>0),analogWrite(n,E.clip(Math.abs(e),0,1),null)}},u=o(P5,P4,100),c=o(P6,P7,100),s={OLED_WIDTH:128,OLED_CHAR:64,OLED_CHUNK:128},l=function(n,t,e){var i=0,r=1,o=null,u=null,c=0;t((function(){c+=r,u&&u(c)&&(i=0,n(0),o&&o())}));var s=null;return function(t){return r=t.direction?1:-1,0===i&&(i=t.startSpeed||.3),u=t.stopCondition,i=Math.min(1,1.05*i),n(i*(e?1:-1)*r),s||(s=new Promise((function(n,t){o=function(){n(c),c=0,s=null,o=null}}))),s}},f=function(){var n=this;this.subscribers=[],this.subscribe=function(t){return n.subscribers.push(t)},this.unsubscribe=function(t){return n.subscribers=n.subscribers.filter((function(n){return n!==t}))},this.publish=function(t){return n.subscribers.forEach((function(n){return n(t)}))}},a={oledReady:new f,irCodes:new f,leftWheelDone:new f,rightWheelDone:new f},h=function(){PrimaryI2C.setup({sda:SDA,scl:SCL});var n=function(n,t,e){var i=new Uint8Array([174,213,128,168,63,211,0,64,141,20,32,0,161,200,218,18,129,207,217,241,219,64,164,166,175]),r=[33,0,s.OLED_WIDTH-1,34,0,7],o=Graphics.createArrayBuffer(s.OLED_WIDTH,i[4]+1,1,{vertical_byte:!0}),u=60;return setTimeout((function(){i.forEach((function(t){n.writeTo(u,[0,t])}))}),50),void 0!==t&&setTimeout(t,100),o.flip=function(){r.forEach((function(t){n.writeTo(u,[0,t])}));var t=new Uint8Array(s.OLED_CHUNK+1);t[0]=s.OLED_CHAR;for(var e=0;e<this.buffer.length;e+=s.OLED_CHUNK)t.set(new Uint8Array(this.buffer,e,s.OLED_CHUNK),1),n.writeTo(u,t)},o.setContrast=function(t){return n.writeTo(u,0,129,t)},o.off=function(){return n.writeTo(u,0,174)},o.on=function(){return n.writeTo(u,0,175)},o}(PrimaryI2C,(function(){return a.oledReady.publish()})),e=t(P10),i=t(P11);!function(n,t){n.mode("input_pullup");var e=0,i=0,r=null,o=function(){0!=e&&(1===e?t(i):(t(e),i=e),e=0)};setWatch((function(n){var t=n.time-n.lastTime;null!==r&&(clearTimeout(r),r=null),t>.04?o():(e=e<<1|+(t>8e-4),r=setTimeout((function(){r=null,o()}),50))}),n,{repeat:!0,edge:"falling"})}(P3,(function(n){return a.irCodes.publish(n)}));var r,o,f=l(c,i,!1),h=l(u,e,!0);return{head:(r=P8,90,.675,2.325,o=function(n,t){switch(t){case"us":n=E.clip(n,675,2325),analogWrite(r,n/1e3/20,{freq:50});break;case"ms":n=E.clip(n,.675,2.325),analogWrite(r,n/20,{freq:50});break;default:n=E.clip(n,0,180),analogWrite(r,.03375+.0004583333333333333*(n-0),{freq:50})}},o(90),o),leftWheel:f,rightWheel:h,oled:n}}(),d={width:128,height:64,bpp:1,buffer:require("heatshrink").decompress(atob("AA0f/ANLgP/AAWAB5N/B4f+BxEPBwYAB+APHBYXgg4ECBwwKCCovgB4s/BAoWB/guGA4wXBMQgXBE4wIGj5HHFAKUEv6aIj6CEFw4wDIAUDVBK2B4CcCU5I6BUQTZLBYc/HxBACFYQzDgIXCj5LEIYQHDUIU/C4YMBCQQnFv43Dv/ADQZjBCgT+EJgMHLwYPIj/gh4PFIgIPEh/wj4GEB5H4EIIvLHoKOEB5BdBOwZvJB4JxBAwYPCDAkB/1/doavHB44AIB6H/B57eDABQPQH75veB4KmDB5S2DVoQADj7fEawIUBB4o6CB4MfB4MDfoR7EFQMH/Ef+BkCKYgGDh/4AIIYCEYIACEwcP+AhBHAQjBAAUPIwQ9BIIIFBn4DCAopdBEohADHwIlCRoJFDCYI0Cj5eCBgYGCeoXwEYIoCFgaQCAYIMBAAI+Cg5SDFYUHB4YXCBYZmDGAQuDPAgzBLgQEBDwZOBdgadFAAY2BXAd/dww+CdAh4BB46GDEoYwGBA55DYAj3FA4QXEDwIXGRoQmENBCcDUQZXHZYQADTgQAGv4ODPggAFVAIACLgqaHUg4A=="))},B=function(n){var t=e[n];t&&t(),e.default&&e.default(n)},T=function(n){e=n,a.irCodes.unsubscribe(B),a.irCodes.subscribe(B)},A=function(){function n(n){this.changed=n,this.seconds=0,this.minutes=0}return n.prototype.tick=function(n){this.seconds+=n,this.seconds>59?(this.seconds=0,this.minutes++):this.seconds<0&&(this.seconds=59,this.minutes--),this.changed(this.toString())},n.prototype.toString=function(){var n=function(n){return n>9?""+n:"0"+n};return n(this.minutes)+":"+n(this.seconds)},n.prototype.startUp=function(){var n=this;this.interval||(this.interval=setInterval((function(){return n.tick(1)}),1e3))},n.prototype.stop=function(){clearInterval(this.interval),this.interval=null},n}(),C=!0,g=!1,I=[],p=null,P=function(n,t){var e=function(){return null==i},r=h.leftWheel({direction:n,stopCondition:e}),o=h.rightWheel({direction:t,stopCondition:e});p||(p=Promise.all([r,o])).then((function(n){var t=n[0],e=n[1];I.push([t,e]),p=null}))},v=function(){if(0!==I.length&&!p){var n=I[I.length-1],t=n[0],e=n[1],i=Promise.resolve(0),r=0==t?i:h.leftWheel({direction:t<0,stopCondition:function(n){return n+t==0}}),o=0==e?i:h.rightWheel({direction:e<0,stopCondition:function(n){return n+e==0}});(p=Promise.all([r,o])).then((function(){setTimeout((function(){I.splice(-1,1),p=null,v()}),1e3)}))}},D=(r=[["Timer",function(){var t;h.oled.setFontVector(40);var e=new A((function(n){h.oled.clear(),h.oled.drawString(n,0,10),h.oled.flip()}));e.startUp(),T(((t={})[n.PLAY]=function(){return e.stop()},t[n.LEFT]=D,t))}],["Marsohod",function(){var t;return T(((t={})[n.TOP]=function(){return P(C,C)},t[n.BOTTOM]=function(){return P(g,g)},t[n.LEFT]=function(){return P(g,C)},t[n.RIGHT]=function(){return P(C,g)},t[n.PLUS]=function(){return h.head(55)},t[n.MINUS]=function(){return h.head(125)},t[n.GREEN]=function(){return h.head(90)},t[n.PLAY]=function(){p||v()},t.default=function(){i&&clearTimeout(i),i=setTimeout((function(){i=null}),150)},t))}],["Else",function(){}]],function(){var t,e=0,i=function(){h.oled.clear();for(var n=0;n<r.length;n++){var t=r[n],i=t[0],o=(t[1],n===e?"> "+i:"  "+i);h.oled.drawString(o,0,20*n)}h.oled.flip()},o=((t={})[n.TOP]=function(){e=Math.max(0,e-1),i()},t[n.BOTTOM]=function(){e=Math.min(r.length-1,e+1),i()},t[n.PLAY]=function(){var n=r[e];n[0],(0,n[1])()},t);i(),T(o)});a.oledReady.subscribe((function(){h.oled&&(h.oled.clear(),h.oled.setFontVector(15),h.oled.drawImage(d,0,0),h.oled.flip()),setTimeout(D,5e3)}))})();